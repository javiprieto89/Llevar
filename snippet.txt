# NO pedir permisos de administrador si estamos en un IDE o modo debug
$isInIDE = Test-IsRunningInIDE

if (-not $isAdmin -and -not $isInIDE) {
    Write-Host "? Se requieren permisos de administrador para redimensionar la consola." -ForegroundColor Yellow
    Write-Host "Ejecuta manualmente como administrador si deseas ese comportamiento." -ForegroundColor Cyan
    # En modo no interactivo no forzamos elevaci¢n para evitar nuevas ventanas
}
elseif (-not $isAdmin -and $isInIDE) {
    Write-Host "? Ejecutando en IDE/Debug - saltando solicitud de permisos de administrador" -ForegroundColor Cyan
}

    Write-Host "ℹ Ejecutando en IDE/Debug - saltando solicitud de permisos de administrador" -ForegroundColor Cyan
}

# ==========================================
#  CONFIGURACIÓN Y LOGS
# ==========================================

$Global:LogFile = Join-Path $env:TEMP "LLEVAR_ERROR.log"

# Inicializar consola si es necesario
$hostName = $host.Name -ilike '*consolehost*'
#Write-Host $hostName
#Pause
if ($hostName) {
    $host.UI.RawUI.BackgroundColor = 'Black'
    $host.UI.RawUI.ForegroundColor = 'White'
    Clear-Host
}

function Resize-Console {
    [CmdletBinding()]
    param (
        [Parameter(Mandatory = $true, Position = 0)]
        [ValidateRange(1, [int]::MaxValue)]
        [int]$Width,
